---
layout: article
title:  "资源加载"
categories: framework
image:
    teaser: /in-post/framework/2019-12-27-资源加载/DefaultImg.jpg
---

# 目录

[TOC]

## 一、写在前面

### 1.使用版本

***Unity版本：2018.3.Of2***

## 二、AssetBundle打包管理

### 1.打包策略

- 设置编辑器工具统一设置AB包名、路径
- 根据依赖关系生成不冗余AB包
- 基于Asset的全路径生成自己的依赖关系表
- 根据自己的依赖关系表加载AB包，编辑器下直接加载资源

**优点：**

- 不需要在打包编辑器可以直接运行游戏
- 不会产生冗余AB包
- 文件夹或文件AB包设置简单方便容易管理

**缺点：**

- 长时间未打包的情况下，打包的时候时间较长

### 2.定义打包配置表

分为两种类型的打包：

- 类型一：基于文件夹下所有单个文件进行打包（用于打包Prefab）

  记录该情况下的所有文件夹的路径，遍历文件夹下的Prefab，逐一打包。

- 类型二：基于文件夹进行打包（用于打包Shader、Sound...）

  记录文件夹的Info：AB包名、文件夹路径

````csharp
    [CreateAssetMenu(fileName = "ABConfig", menuName = "CreateABConfig", order = 1)]
    public class ABConfig : ScriptableObject
    {
        //路径：基于Assets下的路径（eg：Assets/xxx/xxx...）

        //类型一：基于文件夹下所有单个文件进行打包（用于打包Prefab）
        //记录该情况下的所有文件夹的路径
        //遍历文件夹下的Prefab，逐一打包
        public List<string> PrefabsFolderPathList = new List<string>();

        //类型二：基于文件夹进行打包（用于打包Shader、Sound...）
        //记录文件夹的Info：AB包名、文件夹路径
        public List<FilesFolderInfo> FilesFolderInfoList = new List<FilesFolderInfo>();

        [System.Serializable]
        public struct FilesFolderInfo
        {
            public string ABName;
            public string Path;
        }
    }
````

创建出来的ABConfig如下图：

![picture0](https://huskytgame.github.io/images/in-post/framework/2019-12-27-资源加载/ScreenShot000.png)

### 3.打包

````csharp

````

补充：

- 设置``mFliterList``的目的是用于防止AB包冗余的：先缓存类型二的，再缓存类型一；在缓存类型一的时候，类型一的依赖项需经过``mFliterList``过滤后才可加入缓存中。



